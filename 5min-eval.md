# 五分钟推荐系统-评测指标

[toc]

推荐系统的评测指标需要考虑用户，物品和时间3个维度

**用户维度**：用户的人口统计信息、活跃度、新用户

**物品维度**：属性、流行度、平均分、新旧程度

**时间维度**： 工作日-周末-晚上-白天

从这3个维度出发设定评测指标：准确率和召回率，覆盖率，多样性，新颖性， 用户满意度，有效度 商业目标 健壮性、 实时性  信任度   惊喜度。

其中：**准确率和召回率，覆盖率**是最重要的3个指标

### 1、预测准确率和召回率

#### 1.1 预测用户对物品的评分

RMSE均方根误差=实际评分差的平方的平均数，再开根号
MAE均方根误差=实际评分差的平均数

```
def RSME(records):
      allsum= sum(pow(real - predict,2) for real, predict in records) 
      avg = allsum / float(len(records))
      return math.sqrt(avg)   

def MAE(records):
      allsum = sum(abs(real - predict) for real, predict in records) 
      avg = allsum  / float(len(records))
      return math.sqrt(avg)   
```

#### 1.2 TopN 推荐的预测准确率和召回率

**召回率**： 准确的有多少个被预测出来了
                预测集中个数^实际集中个数/实际集中个数
**准确率**： 预测中有多少个准确的
                预测集中个数^实际集中个数/预测集中个数

```python
def recall(tests, N):
     for user,items in tests.items():
           topN = GetTopN(User,N)
           Hit += useritems & topN     # set 交集 累加 
           real_total  += items  # 实际集中数目累加
           predict_total += N  # 预测集中累加,每次预测N ，则每次加 N  
     recall =  hit/ real_total  
     precision =  hit / predict_total 
```

### 2、覆盖率

覆盖率指能够推荐出来得物品占总物品的比例。
**覆盖分布**：每个被推荐的分布应该差不多。
Coverage =   R(u)并集 / 总物品

**方法一、信息熵**

```python
H= -sum(  p(i)log(p(i))  )  
其中 pi= sum(i)/sum(sum(i) )  #i 为第i个物品的流行度 / 所有物品流行度之和 
```

**方法二、基尼系数**：   
j 为第i个物品
G =  sum((2j-n-1)p(ij)) /(n-1)

```python

物品流行度p(ij) 按照流行度排序的第j个物品，给定物品流行度分布后的基尼系数。 
p = (（item,weight）)
def Gini(p): 
         n=len(p)
         j=1
         for item,weight in sorted(p.items(),key=itemgetter(1)):
              G+=(2*j-n-1) * weight
               j=j+1 
         return G/float(n-1)     
```

### 3、用户满意度（后验）

推荐购买率
用户反馈界面
点击率
用户停留时间
转化率

### 4、多样性

R(u) = 推荐列表

假设s(i,j) 定义了用户推荐列表中的物品相似度。

用户多样性 Diversity(R(u))  = 1- 2sum(s(i,j))/ (len(R(u)) (len(R(u))-1)) 

整体多样性=  sum(Diversity(R(u)) ) / len(U)     

举个例子:

用户80%时间看动作片,20%时间看动画片，那么推荐列表中最好是8部动作片和两部动画片。



### 5、新颖性

**推荐给用户他们以前没有听说过的物品**。 

**实现**：把用户之前在网站中对其有过行为的物品从推荐列表中过滤掉。

**评测**：利用推荐结果的平均流行度，不热门的东西有更高的新颖性。

新颖性研究困难的是在不牺牲精度的情况下提高多样性和新颖性



### 6、惊喜度

令用户惊喜的推荐结果是：和用户历史上喜欢的物品不相似，但是但是用户觉得满意的推荐。

内容相似性，可以定义，但是用户满意度只能从问卷或者实验得到。

### 7、信任度 

度量推荐系统信任度 通过问卷调查，或者系统设计的信任度机制，好友曾经买过。

#提高信任度方法：
1- 增加推荐系统的透明度，了解推荐的运行机制
2- 考虑社交网络，利用用户的好友关系给用户做推荐

#例如：
        Epinion.com 的推荐系统，建立了一个用户信任系统，信任用户或者不信任用户，那么在给用户做推荐时，尽量推荐他信任的其他用户评论过的物品。

### 8、实时性

新闻-微博 具有很强的时效性。推昨天新闻，就不如推今天的新闻。

实时实现路径：
1 实时更新推荐列表，满足用户的行为变化，
     例如买了一个IPHONE ， 就实时推荐配件，隔天的离线计算结果，显然不够

     如果推荐列表在用户有行为后，变化不大，或者没有变化，说明推荐系统的实时性不高。

2 推荐系统需要能够将新加入的物品推荐给用户

    新物品的推荐能力，我们可以用户推荐列表中多大比例的物品是当天新加入的来评测。

### 9、健壮性     

健壮性主要是衡量推荐系统抗击作弊的能力。   

1- 行为注入攻击
       推荐系统都是分析用户行为，例如购买A的人 常购买B。那么可以注册很多账号，买A 也买自己的 商品。

2- 评分攻击   豆瓣评分系统，雇人评分。

评测方法：
       模拟攻击 给定数据集和算法，注入噪声。

健壮性优化：

```
1- 选择健壮性高的算法
2- 使用代价较高的用户行为。例如购买，而不是浏览
3- 使用数据前，进行攻击检测，从而对数据进行清理
```

### 10、商业目标

电商网站的目标  销售额
展示广告       广告展示次数
点击广告       广告点击次数

满足用户对内容的需求，也要加快实现商业上的指标。

### 11、有效度

好的推荐引擎应该把最好的的推荐给用户



